{% extends 'charts/base.html' %}

{% block header %}
<title>Moneroj.net - Reddit Subscribers</title>
{% endblock %}

{% block content %}

<!-- Content Wrapper -->
<div id="content-wrapper" style="background-color:rgb(48, 44, 41)">

    <!-- Content Row -->
    <div class="row" style="height: 92%; margin: 10px 10px 10px 10px;">
        <div class="card" id="graph1" style="width: 100%; height: 100%;">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between text-white">
                <h6 class="m-0 text-light">
                    Comments per day on Subreddits /Bitcoin and /CryptoCurrency
                </h6>
                
                <div class="dropdown no-arrow">
                    <a data-toggle="modal" href="#" class="link_graph" data-target="#id_Modal">
                        About this chart?
                    </a>
                </div>
            </div>
            <div class="card-body"  style="width: 100%; height: 100%; margin: 0px 0px 0px 0px; padding: 0px 0px 0px 0px;">
                <div id="graph"  style="width: 100%; height: 100%;  margin: 0px 0px 0px 0px; padding: 0px 0px 0px 0px;"></div>
            </div>
        </div>
    </div>

    <!-- Content Row -->
    <div class="row" style="height: 92%; margin: 10px 10px 10px 10px;">
        <div class="card" id="graph_2" style="width: 100%; height: 100%;">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between text-white">
                <h6 class="m-0 text-light">
                    Comments per day on Subreddit /Monero
                </h6>
                
                <div class="dropdown no-arrow">
                    <a data-toggle="modal" href="#" class="link_graph" data-target="#id_Modal">
                        About this chart?
                    </a>
                </div>
            </div>
            <div class="card-body"  style="width: 100%; height: 100%; margin: 0px 0px 0px 0px; padding: 0px 0px 0px 0px;">
                <div id="graph2"  style="width: 100%; height: 100%;  margin: 0px 0px 0px 0px; padding: 0px 0px 0px 0px;"></div>
            </div>
        </div>
    </div>

</div>
<!-- End of Content Wrapper -->

<!-- Modal -->
<div class="modal fade" id="id_Modal" tabindex="-1" role="dialog" aria-labelledby="Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="Modal">Help about the chart</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Cancelar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                These charts show the total number of users for subreddits /Monero ang /CryptoCurrency as a percentage
                of the total users of /Bitcoin subreddit.
                Sudden spikes in total percentage indicate there's a new wave of people getting into other
                cryptocurrencies, not only in Bitcoin. When /CryptoCurrency dominance increase,
                it makes sense to expect that such projects will appreciate against the BTC pair. However, this is just
                and idea to observe.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Fim do Modal -->

<!-- Page level plugins -->
<script> 
    
    var data1 = {
            type: "scatter",
            mode: "lines",
            name: '/Cryptocurrency',
            x: {{ dates|safe }},
            y: {{ social_crypto|safe }},
            line: {
                color: '#00ffff'
                ,width: 2
            }
        };
        
        var data1_mobile = {
            type: "scatter",
            mode: "lines",
            name: '/Cryptocurrency',
            x: {{ dates|safe }},
            y: {{ social_crypto|safe }},
            line: {
                color: '#00ffff'
                ,width: 2
            }
        };

        var data2 = {
            type: "scatter",
            mode: "lines",
            name: '/Bitcoin',
            x: {{ dates|safe }},
            y: {{ social_btc|safe }},
            line: {
                color: '#ffff00'
                ,width: 2
            }
        };
        
        var data2_mobile = {
            type: "scatter",
            mode: "lines",
            name: '/Bitcoin',
            x: {{ dates|safe }},
            y: {{ social_btc|safe }},
            line: {
                color: '#ffff00'
                ,width: 2
            }
        };

        var data3 = {
            type: "scatter",
            mode: "lines",
            name: '/Monero',
            x: {{ dates|safe }},
            y: {{ social_xmr|safe }},
            line: {
                color: '#dd1d1d'
                ,width: 3
            }
        };
        
        var data3_mobile = {
            type: "scatter",
            mode: "lines",
            name: '/Monero',
            x: {{ dates|safe }},
            y: {{ social_xmr|safe }},
            line: {
                color: '#dd1d1d'
                ,width: 3
            }
        };
    
        var data = [data1, data2];
        var data_2 = [data3];
        var data_mobile = [data1_mobile, data2_mobile];
        var data_mobile_2 = [data3_mobile];

        var layout = {
            plot_bgcolor:"#252221",
            paper_bgcolor:"#252221",
            annotations: [
            {
                xref: 'paper',
                yref: 'paper',
                x: 0.02,
                xanchor: 'auto',
                y: 0.98,
                yanchor: 'auto',
                text: 'Trocador<br>https://trocador.app',
                showarrow: false,
                borderwidth: 1,
                bordercolor: '#5f5f5f',
                bgcolor: '#333333',
                borderpad: 5,
                align: 'center',
                font: {
                color: "white",
                size: 12
                }
            }],
            separators: ",.",
            legend: {
                x: 0.02, 
                y: 0.80, 
                bgcolor: '#333333', 
                bordercolor: '#5f5f5f', 
                borderwidth: 1, 
                font: {
                    color: 'white', 
                    size: 12
                }, 
                traceorder: 'normal', 
                xanchor: 'auto', 
                yanchor: 'auto'
            },
            hoverlabel: {
                namelength: -1
            },
            yaxis: {
                type: "linear",
                title: {
                    text: ' Comments Per Day',
                    font: {
                        size: 20,
                        color: 'white'
                    }
                },
                tickformat :",.0f"
                ,nticks: 10
                ,tickfont: {
                    color: "#ffffff"
                    ,size: 12
                }
                ,gridcolor: "#333333"
            },
            xaxis: {
                hoverformat: "%Y-%m-%d",
                showgrid: true,
                type: 'date',
                nticks: 10
                ,tickfont: {
                    color: "#dddddd"
                    ,size: 13
                }
                ,gridcolor: "#333333"
                ,range: ['2018-11-07', '2025-01-01']
                ,zeroline: true
            },
            margin: {
                l: 120,
                r: 60,
                b: 35,
                t: 10,
                pad: 4
            }
        };
        
        var layout_mobile = {
            plot_bgcolor:"black",
            paper_bgcolor:"black",
            separators: ",.",
            hoverlabel: {
                namelength: -1
            },
            legend: {
                x: 0.02, 
                y: 0.98, 
                bgcolor: '#000000', 
                bordercolor: '#5f5f5f', 
                borderwidth: 1, 
                font: {
                    color: 'white', 
                    size: 5
                }, 
                traceorder: 'normal', 
                xanchor: 'auto', 
                yanchor: 'auto'
            },
            showlegend: false,
            yaxis: {
                type: "linear",
                tickformat :",.0f"
                ,nticks: 10
                ,tickfont: {
                    color: "#ffffff"
                    ,size: 7
                }
                ,gridcolor: "#444444"
            },
            xaxis: {
                hoverformat: "%Y",
                showgrid: true,
                type: 'date',
                nticks: 10
                ,tickfont: {
                    color: "#dddddd"
                    ,size: 7
                }
                ,gridcolor: "#444444"
                ,range: ['2018-11-07', '2025-01-01']
                ,zeroline: true
            },
            margin: {
                l: 40,
                r: 0,
                b: 35,
                t: 10,
                pad: 0
            }
        };


        function findBootstrapEnvironment() {
            let envs = ['xs', 'sm', 'md', 'lg', 'xl'];

            let el = document.createElement('div');
            document.body.appendChild(el);

            let curEnv = envs.shift();

            for (let env of envs.reverse()) {
                el.classList.add(`d-${env}-none`);

                if (window.getComputedStyle(el).display === 'none') {
                    curEnv = env;
                    break;
                }
            }

            document.body.removeChild(el);
            return curEnv;

        }
        env_size = findBootstrapEnvironment();
        if (env_size == "xs") {
            Plotly.newPlot('graph', data_mobile, layout_mobile, {responsive: true, modeBarButtonsToRemove: ['toImage', 'hoverCompareCartesian', 'hoverClosest2d', 'toggleSpikelines', 'lasso2d', 'select2d', 'hoverClosestCartesian'], displaylogo: false});
            Plotly.newPlot('graph2', data_mobile_2, layout_mobile, {responsive: true, modeBarButtonsToRemove: ['toImage', 'hoverCompareCartesian', 'hoverClosest2d', 'toggleSpikelines', 'lasso2d', 'select2d', 'hoverClosestCartesian'], displaylogo: false});
        }
        else {
            Plotly.newPlot('graph', data, layout, {responsive: true, modeBarButtonsToRemove: ['toImage', 'hoverCompareCartesian', 'hoverClosest2d', 'toggleSpikelines', 'lasso2d', 'select2d', 'hoverClosestCartesian'], displaylogo: false});
            Plotly.newPlot('graph2', data_2, layout, {responsive: true, modeBarButtonsToRemove: ['toImage', 'hoverCompareCartesian', 'hoverClosest2d', 'toggleSpikelines', 'lasso2d', 'select2d', 'hoverClosestCartesian'], displaylogo: false});
        }
    </script>

{% endblock %}

